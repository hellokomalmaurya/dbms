<html>
    <head></head>
    <body>
        <h1>SQL - Self Join</h1>
        <p>The <b>SQL Self</b> Join is used to join a table to itself as if the table were two tables. To carry this out, alias of the tables should be used<br>
             at least once.</p>
        <p>Self Join is a type of inner join, which is performed in cases where the comparison between two columns of a same table is required; probably to establish a relationship between them.<br>
             In other words, a table is joined with itself when it contains both <b>Foreign Key</b> and <b>Primary Key</b> in it.</p>
        <h3>Syntax</h3>
        Following is the basic syntax of SQL Self Join:<br>
        <pre>SELECT column_name(s)
            FROM table1 a, table1 b
            WHERE a.common_field = b.common_field;</pre>
        <p>Here, the WHERE clause could be any given expression based on your requirement.</p>
        <h3>Example</h3>
        <p>Self Join only requires one table, so, let us create a CUSTOMERS table containing the customer details like their names, age, address and the salary they earn.</p>
        <pre>CREATE TABLE CUSTOMERS (
            ID INT NOT NULL,
            NAME VARCHAR (20) NOT NULL,
            AGE INT NOT NULL,
            ADDRESS CHAR (25),
            SALARY DECIMAL (18, 2),       
            PRIMARY KEY (ID)
         );</pre>
         <p>Now, insert values into this table using the INSERT statement as follows:</p>
        <pre>INSERT INTO CUSTOMERS VALUES
            (1, 'Ramesh', 32, 'Ahmedabad', 2000.00 ),
            (2, 'Khilan', 25, 'Delhi', 1500.00 ),
            (3, 'Kaushik', 23, 'Kota', 2000.00 ),
            (4, 'Chaitali', 25, 'Mumbai', 6500.00 ),
            (5, 'Hardik', 27, 'Bhopal', 8500.00 ),
            (6, 'Komal', 22, 'Hyderabad', 4500.00 ),
            (7, 'Muffy', 24, 'Indore', 10000.00 );</pre>
            he table will be created as:<br>
        <img src="sj1.png" height="30%" width="45%">
        <p>Now, let us join this table using the following Self Join query. Our aim is to establish a relationship among the said Customers on the basis of their earnings. <br>
            We are doing this with the help of the WHERE clause.</p>
        <pre>SELECT a.ID, b.NAME as EARNS_HIGHER, a.NAME 
            as EARNS_LESS, a.SALARY as LOWER_SALARY
            FROM CUSTOMERS a, CUSTOMERS b
            WHERE a.SALARY < b.SALARY;</pre>
            <h3>Output</h3>
            <img src="sj2.png" height="60%" width="40%"><br>
            <img src="sj3.png" height="30%" width="40%">
    </body>
</html>